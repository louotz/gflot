const Canvas2Image=(function(){const l=(function(){const q=document.createElement("canvas"),p=q.getContext("2d");return{canvas:!!p,imageData:!!p.getImageData,dataURL:!!q.toDataURL,btoa:!!window.btoa}})();const k="image/octet-stream";function j(r,t,p){const q=r.width,s=r.height;if(t===undefined){t=q}if(p===undefined){p=s}let retCanvas=document.createElement("canvas");let retCtx=retCanvas.getContext("2d");retCanvas.width=t;retCanvas.height=p;retCtx.drawImage(r,0,0,q,s,0,0,t,p);return retCanvas}function h(q,s,r,p){q=j(q,r,p);return q.toDataURL(s)}function d(q,p,r){let saveLink=document.createElement("a");saveLink.download=r+"."+p;saveLink.href=q;saveLink.click()}function b(p){let img=document.createElement("img");img.src=p;return img}function e(p){p=p.toLowerCase().replace(/jpg/i,"jpeg");const q=p.match(/png|jpeg|bmp|gif/)[0];return"image/"+q}function f(p){if(!window.btoa){throw"btoa undefined"}let str="";if(typeof p=="string"){str=p}else{for(let i=0;i<p.length;i++){str+=String.fromCharCode(p[i])}}return btoa(str)}function m(q){const p=q.width,r=q.height;return q.getContext("2d").getImageData(0,0,p,r)}function a(q,p){return"data:"+p+";base64,"+q}const o=function(p){const q=p.width;const v=p.height;const C=q*v*3;const A=C+54;const u=[66,77,A&255,(A>>8)&255,(A>>16)&255,(A>>24)&255,0,0,0,0,54,0,0,0];const s=[40,0,0,0,q&255,(q>>8)&255,(q>>16)&255,(q>>24)&255,v&255,(v>>8)&255,(v>>16)&255,(v>>24)&255,1,0,24,0,0,0,0,0,C&255,(C>>8)&255,(C>>16)&255,(C>>24)&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];const z=(4-((q*3)%4))%4;const w=p.data;let strPixelData="";const B=q<<2;let y=v;const D=String.fromCharCode;do{const r=B*(y-1);let strPixelRow="";for(let x=0;x<q;x++){const t=x<<2;strPixelRow+=D(w[r+t+2])+D(w[r+t+1])+D(w[r+t])}for(let c=0;c<z;c++){strPixelRow+=String.fromCharCode(0)}strPixelData+=strPixelRow}while(--y);return(f(u.concat(s))+f(strPixelData))};const g=function(q,p,w,u,s){const z=u;if(l.canvas&&l.dataURL){if(typeof q=="string"){q=document.getElementById(q)}if(u===undefined){u="png"}u=e(u);if(/bmp/.test(u)){const t=m(j(q,p,w));const v=o(t);d(a(bitmapStrData,k),z,s)}else{const r=h(q,u,p,w);d(r.replace(u,k),z,s)}}};const n=function(r,u,p,t){if(l.canvas&&l.dataURL){if(typeof r=="string"){r=document.getElementById(r)}if(t===undefined){t="png"}t=e(t);if(/bmp/.test(t)){const v=m(j(r,u,p));const q=o(v);return b(a(q,"image/bmp"))}else{const s=h(r,t,u,p);return b(s)}}};return{saveAsImage:g,saveAsPNG:function(q,r,p,s){return g(q,r,p,"png",s)},saveAsJPEG:function(q,r,p,s){return g(q,r,p,"jpeg",s)},saveAsGIF:function(q,r,p,s){return g(q,r,p,"gif",s)},saveAsBMP:function(q,r,p,s){return g(q,r,p,"bmp",s)},convertToImage:n,convertToPNG:function(q,r,p){return n(q,r,p,"png")},convertToJPEG:function(q,r,p){return n(q,r,p,"jpeg")},convertToGIF:function(q,r,p){return n(q,r,p,"gif")},convertToBMP:function(q,r,p){return n(q,r,p,"bmp")}}})();
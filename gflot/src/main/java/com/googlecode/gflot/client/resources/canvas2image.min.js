'use strict';const Canvas2Image=function(){function m(a,b,c){const d=a.width,e=a.height;void 0===b&&(b=d);void 0===c&&(c=e);let f=document.createElement("canvas"),g=f.getContext("2d");f.width=b;f.height=c;g.drawImage(a,0,0,d,e,0,0,b,c);return f}function u(a,b,c){let d=document.createElement("a");d.download=c+"."+b;d.href=a;d.click()}function v(a){let b=document.createElement("img");b.src=a;return b}function w(a){a=a.toLowerCase().replace(/jpg/i,"jpeg");return"image/"+a.match(/png|jpeg|bmp|gif/)[0]}
function x(a){if(!window.btoa)throw"btoa undefined";let b="";if("string"==typeof a)b=a;else for(let c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return btoa(b)}function y(a){const b=a.width,c=a.height;return a.getContext("2d").getImageData(0,0,b,c)}const n=function(){const a=document.createElement("canvas"),b=a.getContext("2d");return{canvas:!!b,imageData:!!b.getImageData,dataURL:!!a.toDataURL,btoa:!!window.btoa}}(),z=function(a){const b=a.width;var c=a.height,d=b*c*3,e=d+54;e=[66,77,e&255,e>>
8&255,e>>16&255,e>>24&255,0,0,0,0,54,0,0,0];d=[40,0,0,0,b&255,b>>8&255,b>>16&255,b>>24&255,c&255,c>>8&255,c>>16&255,c>>24&255,1,0,24,0,0,0,0,0,d&255,d>>8&255,d>>16&255,d>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];const f=(4-3*b%4)%4;a=a.data;let g="";const A=b<<2,p=String.fromCharCode;do{var h=A*(c-1);let q="";for(let r=0;r<b;r++){const t=r<<2;q+=p(a[h+t+2])+p(a[h+t+1])+p(a[h+t])}for(h=0;h<f;h++)q+=String.fromCharCode(0);g+=q}while(--c);return x(e.concat(d))+x(g)},k=function(a,b,c,d,e){const f=d;if(n.canvas&&
n.dataURL)if("string"==typeof a&&(a=document.getElementById(a)),void 0===d&&(d="png"),d=w(d),/bmp/.test(d))d=y(m(a,b,c)),z(d),u("data:image/octet-stream;base64,"+bitmapStrData,f,e);else{var g=d;a=m(a,b,c);g=a.toDataURL(g);u(g.replace(d,"image/octet-stream"),f,e)}},l=function(a,b,c,d){if(n.canvas&&n.dataURL){"string"==typeof a&&(a=document.getElementById(a));void 0===d&&(d="png");d=w(d);if(/bmp/.test(d))return a=y(m(a,b,c)),a=z(a),v("data:image/bmp;base64,"+a);a=m(a,b,c);a=a.toDataURL(d);return v(a)}};
return{saveAsImage:k,saveAsPNG:function(a,b,c,d){return k(a,b,c,"png",d)},saveAsJPEG:function(a,b,c,d){return k(a,b,c,"jpeg",d)},saveAsGIF:function(a,b,c,d){return k(a,b,c,"gif",d)},saveAsBMP:function(a,b,c,d){return k(a,b,c,"bmp",d)},convertToImage:l,convertToPNG:function(a,b,c){return l(a,b,c,"png")},convertToJPEG:function(a,b,c){return l(a,b,c,"jpeg")},convertToGIF:function(a,b,c){return l(a,b,c,"gif")},convertToBMP:function(a,b,c){return l(a,b,c,"bmp")}}}();